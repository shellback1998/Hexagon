VERSION 5.00
Begin VB.Form frmMain 
   BackColor       =   &H80000002&
   Caption         =   "Main Form"
   ClientHeight    =   5280
   ClientLeft      =   45
   ClientTop       =   435
   ClientWidth     =   9150
   LinkTopic       =   "Form1"
   ScaleHeight     =   5280
   ScaleWidth      =   9150
   StartUpPosition =   3  'Windows Default
   Begin VB.CommandButton cmdLab87a 
      Caption         =   "Lab87a"
      Height          =   375
      Left            =   7440
      TabIndex        =   43
      Top             =   3960
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab87 
      Caption         =   "Lab 87"
      Height          =   375
      Left            =   3840
      TabIndex        =   42
      Top             =   3480
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab86 
      Caption         =   "Lab 86"
      Height          =   375
      Left            =   3840
      TabIndex        =   41
      Top             =   3000
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab85 
      Caption         =   "Lab 85"
      Height          =   375
      Left            =   3840
      TabIndex        =   40
      Top             =   2520
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab84 
      Caption         =   "Lab 84"
      Height          =   375
      Left            =   3840
      TabIndex        =   39
      Top             =   2040
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab83 
      Caption         =   "Lab 83"
      Height          =   375
      Left            =   3840
      TabIndex        =   38
      Top             =   1560
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab82 
      Caption         =   "Lab 82"
      Height          =   375
      Left            =   3840
      TabIndex        =   37
      Top             =   1080
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab81 
      Caption         =   "Lab 81"
      Height          =   375
      Left            =   3840
      TabIndex        =   36
      Top             =   600
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab80 
      Caption         =   "Lab 80"
      Height          =   375
      Left            =   3840
      TabIndex        =   35
      Top             =   120
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab79 
      Caption         =   "Lab 79"
      Height          =   375
      Left            =   2640
      TabIndex        =   34
      Top             =   4440
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab78 
      Caption         =   "Lab 78"
      Height          =   375
      Left            =   2640
      TabIndex        =   33
      Top             =   3960
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab77 
      Caption         =   "Lab 77"
      Height          =   375
      Left            =   2640
      TabIndex        =   32
      Top             =   3480
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab76 
      Caption         =   "Lab 76"
      Height          =   375
      Left            =   2640
      TabIndex        =   31
      Top             =   3000
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab75 
      Caption         =   "Lab 75"
      Height          =   375
      Left            =   2640
      TabIndex        =   30
      Top             =   2520
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab74 
      Caption         =   "Lab 74"
      Height          =   375
      Left            =   2640
      TabIndex        =   29
      Top             =   2040
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab73 
      Caption         =   "Lab 73"
      Height          =   375
      Left            =   2640
      TabIndex        =   28
      Top             =   1560
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab72 
      Caption         =   "Lab 72"
      Height          =   375
      Left            =   2640
      TabIndex        =   27
      Top             =   1080
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab71 
      Caption         =   "Lab 71"
      Height          =   375
      Left            =   2640
      TabIndex        =   26
      Top             =   600
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab70 
      Caption         =   "Lab 70"
      Height          =   375
      Left            =   2640
      TabIndex        =   25
      Top             =   120
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab69 
      Caption         =   "Lab 69"
      Height          =   375
      Left            =   1440
      TabIndex        =   24
      Top             =   4440
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab68 
      Caption         =   "Lab 68"
      Height          =   375
      Left            =   1440
      TabIndex        =   23
      Top             =   3960
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab67 
      Caption         =   "Lab 67"
      Height          =   375
      Left            =   1440
      TabIndex        =   22
      Top             =   3480
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab66 
      Caption         =   "Lab 66"
      Height          =   375
      Left            =   1440
      TabIndex        =   21
      Top             =   3000
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab65 
      Caption         =   "Lab 65"
      Height          =   375
      Left            =   1440
      TabIndex        =   20
      Top             =   2520
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab64a 
      Caption         =   "Lab 64a"
      Height          =   375
      Left            =   1440
      TabIndex        =   19
      Top             =   2040
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab64 
      Caption         =   "Lab 64"
      Height          =   375
      Left            =   1440
      TabIndex        =   18
      Top             =   1560
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab63 
      Caption         =   "Lab 63"
      Height          =   375
      Left            =   1440
      TabIndex        =   17
      Top             =   1080
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab62 
      Caption         =   "Lab 62"
      Height          =   375
      Left            =   1440
      TabIndex        =   16
      Top             =   600
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab61 
      Caption         =   "Lab 61"
      Height          =   375
      Left            =   1440
      TabIndex        =   15
      Top             =   120
      Width           =   1095
   End
   Begin VB.CommandButton cmdLab60 
      Caption         =   "Lab 60"
      Height          =   375
      Left            =   120
      TabIndex        =   14
      Top             =   4440
      Width           =   1215
   End
   Begin VB.CommandButton cmdLab59 
      Caption         =   "Lab 59"
      Height          =   375
      Left            =   120
      TabIndex        =   13
      Top             =   3960
      Width           =   1215
   End
   Begin VB.CommandButton cmdLab57 
      Caption         =   "Lab 57"
      Height          =   375
      Left            =   120
      TabIndex        =   12
      Top             =   3000
      Width           =   1215
   End
   Begin VB.CommandButton cmdLab58 
      Caption         =   "Lab 58"
      Height          =   375
      Left            =   120
      TabIndex        =   11
      Top             =   3480
      Width           =   1215
   End
   Begin VB.CommandButton cmdLab56 
      Caption         =   "Lab 56"
      Height          =   375
      Left            =   120
      TabIndex        =   10
      Top             =   2520
      Width           =   1215
   End
   Begin VB.CommandButton cmdLab55 
      Caption         =   "Lab 55"
      Height          =   375
      Left            =   120
      TabIndex        =   9
      Top             =   2040
      Width           =   1215
   End
   Begin VB.CommandButton cmdLab54 
      Caption         =   "Lab 54"
      Height          =   375
      Left            =   120
      TabIndex        =   8
      Top             =   1560
      Width           =   1215
   End
   Begin VB.TextBox txtBox1 
      Height          =   285
      Left            =   5520
      TabIndex        =   7
      Text            =   "Text1"
      Top             =   2400
      Width           =   1815
   End
   Begin VB.CommandButton cmdLab53 
      Caption         =   "Lab 53"
      Height          =   375
      Left            =   120
      TabIndex        =   6
      Top             =   1080
      Width           =   1215
   End
   Begin VB.CommandButton cmdLab52 
      Caption         =   "Lab 52"
      Height          =   375
      Left            =   120
      TabIndex        =   5
      Top             =   600
      Width           =   1215
   End
   Begin VB.CommandButton cmdLab51 
      Caption         =   "Lab 51"
      Height          =   375
      Left            =   120
      TabIndex        =   4
      Top             =   120
      Width           =   1215
   End
   Begin VB.CommandButton cmdExit 
      Caption         =   "E&xit"
      Height          =   372
      Left            =   6000
      TabIndex        =   3
      Top             =   1920
      Width           =   1092
   End
   Begin VB.Frame Options 
      Caption         =   "Options"
      Height          =   1332
      Left            =   5160
      TabIndex        =   0
      Top             =   240
      Width           =   2772
      Begin VB.OptionButton Option2 
         Caption         =   "Use PIDDatasource"
         Height          =   252
         Left            =   360
         TabIndex        =   2
         Top             =   840
         Width           =   2172
      End
      Begin VB.OptionButton Option1 
         Caption         =   "Use New LMADatasource"
         Height          =   372
         Left            =   360
         TabIndex        =   1
         Top             =   360
         Value           =   -1  'True
         Width           =   2172
      End
   End
End
Attribute VB_Name = "frmMain"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private blnUsePIDDatasource As Boolean
Private Const CONST_SPID_ModelItem As String = "D6BB4EF0C76F41DFA4116619258CC92F"
Private Const CONST_SPID_ItemNote As String = "D0D9F38E9B9240B0933C86EBFA0F214F"
Private Const CONST_SPID_OPC As String = "14B52777222C466CA3E8EB89ABCC7164"
Private Const CONST_SPID_Vessel As String = "D6BB4EF0C76F41DFA4116619258CC92F"
Private Const CONST_SPID_PipeRun As String = "770871FB53D747B5875D91A87D7356EB"
Private Const CONST_SPID_PipingComp As String = "2E3F163537234E2E9539CF5B6762202E"
Private Const CONST_SPID_OfflineInstrument As String = "765168BE51DE492995F6C605CFDDD89B"
Private Const CONST_SPID_InlineInstrument As String = "0F7008C96715498BB300B57E02900F0E"
Private Const CONST_SPID_LabelPersist As String = "3B1C747DD63E4271A4969178650E9965"
Private Const CONST_SPID_OPC2 As String = "D5AECC6BCA8E46009BFCEA2FBAA5DDC2"



Private Sub cmdLab51_Click()
 Dim datasource As LMADataSource
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    Dim objFilter As LMAFilter
    Dim criterion As LMACriterion
    Set criterion = New LMACriterion
    Set objFilter = New LMAFilter
    
    criterion.SourceAttributeName = "Representation.Drawing.Name"
    criterion.ValueAttribute = "1001"
    criterion.Operator = "="
    objFilter.ItemType = "OPC"
    objFilter.Criteria.Add criterion
    
    Dim objOPC As LMOPC
    Dim objOPCs As LMOPCs
    Dim objpairOPC As LMOPC
    Dim objRep As LMRepresentation
    Dim objPiperun As LMPipeRun
    Dim objSym As LMSymbol
    Dim objConnector As LMConnector
    
    Set objOPCs = New LMOPCs
    objOPCs.Collect datasource, Filter:=objFilter
    
    Debug.Print "Total OPCs were found: " & objOPCs.Count
    
    For Each objOPC In objOPCs
        Set objpairOPC = objOPC.pairedWithOPCObject
        For Each objRep In objpairOPC.Representations
            If objRep.DrawingID > 0 Then
                Debug.Print "pairOPC is on drawing: " & objRep.DrawingObject.Attributes("Name").Value
            End If
            Set objSym = datasource.GetSymbol(objRep.ID)
            For Each objConnector In objSym.Connect1Connectors
                Set objPiperun = datasource.GetPipeRun(objConnector.ModelItemID)
                Debug.Print "pairOPC is connected to Piperun: " & objPiperun.Attributes("ItemTag").Value
            Next
            For Each objConnector In objSym.Connect2Connectors
                Set objPiperun = datasource.GetPipeRun(objConnector.ModelItemID)
                Debug.Print objPiperun.Attributes("ItemTag").Value
            Next
        Next
    Next
    
    Set datasource = Nothing
    Set objOPCs = Nothing
    Set objOPC = Nothing
    Set objpairOPC = Nothing
    Set objRep = Nothing
    Set objSym = Nothing
    Set objPiperun = Nothing
    Set objConnector = Nothing

End Sub

Private Sub cmdLab52_Click()
Dim datasource As LMADataSource
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    Dim objPipingComp As LMPipingComp
    Dim objRepresentation As LMRepresentation
    Dim objRelationships As LMRelationships
    Dim objRelationship As LMRelationship
    Dim objAttribute As LMAAttribute
    
    Set objPipingComp = datasource.GetPipingComp(CONST_SPID_PipingComp)
    Set objRepresentation = objPipingComp.Representations.Nth(1)
    Set objRelationships = objRepresentation.Relation1Relationships
    For Each objRelationship In objRelationships
        If Not objRelationship.Item1RepresentationObject Is Nothing Then
            Debug.Print objRelationship.Item1RepresentationObject.ModelItemObject.AsLMAItem.ItemType
        End If
        If Not objRelationship.Item2RepresentationObject Is Nothing Then
            Debug.Print objRelationship.Item2RepresentationObject.ModelItemObject.AsLMAItem.ItemType
        End If
        For Each objAttribute In objRelationship.Attributes
            Debug.Print "Name: " & objAttribute.Name & Space(20 - Len(objAttribute.Name)) & "Value: " & objAttribute.Value
        Next
    Next
    
    Set objRelationships = objRepresentation.Relation2Relationships
    For Each objRelationship In objRelationships
        If Not objRelationship.Item1RepresentationObject Is Nothing Then
            Debug.Print objRelationship.Item1RepresentationObject.ModelItemObject.AsLMAItem.ItemType
        End If
        If Not objRelationship.Item2RepresentationObject Is Nothing Then
            Debug.Print objRelationship.Item2RepresentationObject.ModelItemObject.AsLMAItem.ItemType
        End If
        For Each objAttribute In objRelationship.Attributes
            Debug.Print "Name: " & objAttribute.Name & Space(20 - Len(objAttribute.Name)) & "Value: " & objAttribute.Value
        Next
    Next
    
    Set datasource = Nothing
    Set objPipingComp = Nothing
    Set objRepresentation = Nothing
    Set objRelationships = Nothing
    Set objRelationship = Nothing
    Set objAttribute = Nothing


End Sub

Private Sub cmdLab53_Click()
Dim datasource As LMADataSource
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    Dim objFilter As LMAFilter
    Dim criterion As LMACriterion
    
    Set criterion = New LMACriterion
    Set objFilter = New LMAFilter
    
    criterion.SourceAttributeName = "Name"
    criterion.ValueAttribute = txtBox1.Text
    criterion.Operator = "="
    objFilter.ItemType = "Drawing"
    objFilter.Criteria.Add criterion
    
    Dim objDrawing As LMDrawing
    Dim objDrawings As LMDrawings
    Set objDrawings = New LMDrawings
    objDrawings.Collect datasource, Filter:=objFilter

    Dim objRelationships As LMRelationships
    Dim objRelationship As LMRelationship
    Dim objInconsistencies As LMInconsistencies
    Dim objInconsistency As LMInconsistency
    Dim objAttribute As LMAAttribute
    
    For Each objDrawing In objDrawings
        Set objRelationships = objDrawing.Relationships
        For Each objRelationship In objRelationships
            Set objInconsistencies = objRelationship.Inconsistencies
            For Each objInconsistency In objInconsistencies
                For Each objAttribute In objInconsistency.Attributes
                    Debug.Print "Name: " & objAttribute.Name & Space(20 - Len(objAttribute.Name)) & "Value: " & objAttribute.Value
                Next
            Next
        Next
    Next
    
    Set datasource = Nothing
    Set objDrawings = Nothing
    Set objDrawing = Nothing
    Set objRelationships = Nothing
    Set objRelationship = Nothing
    Set objInconsistencies = Nothing
    Set objInconsistency = Nothing
 

End Sub

Private Sub cmdLab54_Click()
Dim datasource As LMADataSource
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    Dim objFilter As LMAFilter
    Dim criterion As LMACriterion
    
    Set criterion = New LMACriterion
    Set objFilter = New LMAFilter
    
    criterion.SourceAttributeName = "Name"
    criterion.ValueAttribute = "1001"
    criterion.Operator = "="
    objFilter.ItemType = "Drawing"
    objFilter.Criteria.Add criterion
    
    Dim objDrawing As LMDrawing
    Dim objDrawings As LMDrawings
    Set objDrawings = New LMDrawings
    objDrawings.Collect datasource, Filter:=objFilter

    Dim objRelationships As LMRelationships
    Dim objRelationship As LMRelationship
    Dim objRuleReferences As LMRuleReferences
    Dim objRuleReference As LMRuleReference
    Dim objAttribute As LMAAttribute
    
    For Each objDrawing In objDrawings
        Set objRelationships = objDrawing.Relationships
        For Each objRelationship In objRelationships
            Set objRuleReferences = objRelationship.RuleReferences
            For Each objRuleReference In objRuleReferences
                For Each objAttribute In objRuleReference.Attributes
                    Debug.Print "Name: " & objAttribute.Name & Space(20 - Len(objAttribute.Name)) & "Value: " & objAttribute.Value
                Next
            Next
        Next
    Next
    
    Set datasource = Nothing
    Set objDrawings = Nothing
    Set objDrawing = Nothing
    Set objRelationships = Nothing
    Set objRelationship = Nothing
    Set objRuleReferences = Nothing
    Set objRuleReference = Nothing


End Sub

Private Sub cmdLab55_Click()
    Dim datasource As LMADataSource
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    Dim objVessel As LMVessel
    Set objVessel = datasource.GetVessel(CONST_SPID_Vessel)
        
    Dim objPlantGroup As LMPlantGroup
    
    'get the plantgroup just above the drawing, in our case, should be unit
    Set objPlantGroup = objVessel.PlantGroupObject
    Debug.Print "PlantGroup Name = " & objPlantGroup.Attributes("Name").Value
    
    Dim strParentID As String
    strParentID = objPlantGroup.Attributes("ParentID").Value
    
    Dim objParentPlantGroup As LMPlantGroup
    Set objParentPlantGroup = datasource.GetPlantGroup(strParentID)
    Debug.Print "Parent PlantGroup Name = " & objParentPlantGroup.Attributes("Name").Value
    
    Set datasource = Nothing
    Set objVessel = Nothing
    Set objPlantGroup = Nothing
    Set objParentPlantGroup = Nothing


End Sub

Private Sub cmdLab56_Click()
 Dim datasource As LMADataSource
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    Dim objVessel As LMVessel
    Set objVessel = datasource.GetVessel(CONST_SPID_Vessel)
        
    Dim objPlantGroup As LMPlantGroup
    
    'get the plantgroup just above the drawing, in our case, should be unit
    Set objPlantGroup = objVessel.Representations.Nth(1).DrawingObject.PlantGroupObject
    Debug.Print "PlantGroup Name = " & objPlantGroup.Attributes("Name").Value
    
    Dim strParentID As String
    strParentID = objPlantGroup.Attributes("ParentID").Value
    
    Dim objParentPlantGroup As LMPlantGroup
    Set objParentPlantGroup = datasource.GetPlantGroup(strParentID)
    Debug.Print "Parent PlantGroup Name = " & objParentPlantGroup.Attributes("Name").Value
        
    Set datasource = Nothing
    Set objVessel = Nothing
    Set objPlantGroup = Nothing
    Set objParentPlantGroup = Nothing

End Sub

Private Sub cmdLab57_Click()
Dim datasource As LMADataSource
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If

    Dim objVessel As LMVessel
    Set objVessel = datasource.GetVessel(CONST_SPID_Vessel)    'get objVessel by id
    Debug.Print objVessel.PlantGroupObject.Attributes("T1")
    Debug.Print datasource.GetItem("SPMSubArea", objVessel.PlantGroupID).Attributes("T1")
        
    Set datasource = Nothing
    Set objVessel = Nothing

End Sub

Private Sub cmdLab58_Click()
Dim datasource As LMADataSource
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    
    Dim objVessel As LMVessel
    Set objVessel = datasource.GetVessel(CONST_SPID_Vessel)
    
    Dim objDrawing As LMDrawing
    Set objDrawing = datasource.GetDrawing(objVessel.Representations.Nth(1).DrawingID)
    
    Dim objPlantGroup As LMPlantGroup
    'get the plantgroup just above the drawing, in our case, should be unit
    Set objPlantGroup = objDrawing.PlantGroupObject
    
    Dim objWSSite As LMWSSite
    
    Set objWSSite = objPlantGroup.WSSiteObject
    
    Dim objAttr As LMAAttribute
    Debug.Print "How many attributes? " & objWSSite.Attributes.Count
    For Each objAttr In objWSSite.Attributes
        Debug.Print "Attribute Name: " & objAttr.Name & "     Attribute Value: " & objAttr.Value
    Next
    
    Dim objOPC As LMOPC
    Debug.Print "Total OPCs in WS Site: " & objWSSite.OPCs.Count
    For Each objOPC In objWSSite.OPCs
        Debug.Print objOPC.Attributes("OPCTag").Value
        Debug.Print objOPC.WSSiteObject.Attributes("Name").Value
    Next
    
    Dim objPlantItemGroup As LMPlantItemGroup
    Debug.Print "Total PlantItemGroups in WS Site: " & objWSSite.PlantItemGroups.Count
    For Each objPlantItemGroup In objWSSite.PlantItemGroups
        Debug.Print objPlantItemGroup.Attributes("PlantItemGroupType").Value
        Debug.Print objPlantItemGroup.WSSiteObject.Attributes("Name").Value
    Next
    
    
    Debug.Print "Total PlantGroups in WS Site: " & objWSSite.PlantGroups.Count
    For Each objPlantGroup In objWSSite.PlantGroups
        Debug.Print objPlantGroup.Attributes("PlantGroupType").Value
        Debug.Print objPlantGroup.Attributes("Name").Value
        Debug.Print objPlantGroup.WSSiteObject.Attributes("Name").Value
    Next
    
    Dim objDrawingSite As LMDrawingSite
    Debug.Print "Total DrawingSites in WS Site: " & objWSSite.DrawingSites.Count
    For Each objDrawingSite In objWSSite.DrawingSites
        Debug.Print objDrawingSite.Attributes("Name").Value
        Debug.Print objDrawingSite.WSSiteObject.Attributes("Name").Value
    Next
    
    Set datasource = Nothing
    Set objVessel = Nothing
    Set objDrawing = Nothing
    Set objPlantGroup = Nothing
    Set objAttr = Nothing
    Set objOPC = Nothing
    Set objPlantItemGroup = Nothing
    Set objDrawingSite = Nothing

End Sub

Private Sub cmdLab59_Click()
 Dim datasource As LMADataSource
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    Dim objVessel As LMVessel
    Set objVessel = datasource.GetVessel(CONST_SPID_Vessel)
    
    Dim objDrawing As LMDrawing
    Set objDrawing = datasource.GetDrawing(objVessel.Representations.Nth(1).DrawingID)
    
    Dim objDrawingSite As LMDrawingSite
    Set objDrawingSite = objDrawing.DrawingSites.Nth(1)
    
    Dim objAttr As LMAAttribute
    Debug.Print "How many attributes? " & objDrawingSite.Attributes.Count
    For Each objAttr In objDrawingSite.Attributes
        Debug.Print "Attribute Name: " & objAttr.Name & "     Attribute Value: " & objAttr.Value
    Next
        
    Dim objDrawingSubscriber As LMDrawingSubscriber
    Debug.Print "Total drawing subscriber: " & objDrawingSite.DrawingSubscribers.Count
    For Each objDrawingSubscriber In objDrawingSite.DrawingSubscribers
        Debug.Print objDrawingSubscriber.DrawingSiteObject.Attributes("Name").Value
        Debug.Print objDrawingSubscriber.WSSiteObject.Attributes("Name").Value
    Next
    
    Debug.Print objDrawingSite.DrawingObject.Attributes("Name").Value
    Debug.Print objDrawingSite.WSSiteObject.Attributes("Name").Value
    If Not objDrawingSite.ToWSSiteWSSiteObject Is Nothing Then
        Debug.Print objDrawingSite.ToWSSiteWSSiteObject.Attributes("Name").Value
    End If
    Debug.Print objDrawingSite.PlantGroupObject.Attributes("Name").Value
    
    Set datasource = Nothing
    Set objVessel = Nothing
    Set objDrawing = Nothing
    Set objDrawingSite = Nothing
    Set objDrawingSubscriber = Nothing
    Set objAttr = Nothing

End Sub

Private Sub cmdLab60_Click()
Dim datasource As LMADataSource
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If

    datasource.BeginTransaction
 
    Dim objVessel As LMVessel
    Set objVessel = datasource.GetVessel(CONST_SPID_Vessel)
    Debug.Print objVessel.Attributes("Name").Value
    'expects error in following code, "Read Only attribute"
    objVessel.Attributes("Name").Value = "InWorkshare"
    objVessel.Commit
    
    datasource.CommitTransaction
    
    Set datasource = Nothing
    Set objVessel = Nothing

End Sub

Private Sub cmdLab61_Click()
Dim datasource As LMADataSource
    Dim objActiveProject As LMActiveProject
    Dim objAttribute As LMAAttribute
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    Set objActiveProject = datasource.GetActiveProject
    For Each objAttribute In objActiveProject.Attributes
        Debug.Print "Name: " & objAttribute.Name & Space(20 - Len(objAttribute.Name)) & "Value: " & objAttribute.Value
    Next

    Set datasource = Nothing
    Set objActiveProject = Nothing
    Set objAttribute = Nothing

End Sub

Private Sub cmdLab62_Click()
    Dim datasource As LMADataSource
    Dim objPlantGroups As LMPlantGroups
    Dim objPlantGroup As LMPlantGroup
    Dim objAttribute As LMAAttribute
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    Set objPlantGroups = New LMPlantGroups
    objPlantGroups.Collect datasource
    
    Debug.Print "Total PlantGroups: " & objPlantGroups.Count
    
    For Each objPlantGroup In objPlantGroups
        For Each objAttribute In objPlantGroup.Attributes
            Debug.Print "Name: " & objAttribute.Name & Space(20 - Len(objAttribute.Name)) & "Value: " & objAttribute.Value
            If objAttribute.Name = "Depth" And objAttribute.Value = "0" Then
                MsgBox "ThePlant is: " & objPlantGroup.Attributes("Name")
            End If
        Next
    Next

    Set datasource = Nothing
    Set objPlantGroups = Nothing
    Set objPlantGroup = Nothing
    Set objAttribute = Nothing

End Sub

Private Sub cmdLab63_Click()
Dim datasource As LMADataSource
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    Dim objVessel As LMVessel
    Set objVessel = datasource.GetVessel(CONST_SPID_Vessel)    'get objVessel by id
    
    'check Claim status
    Debug.Print datasource.GetModelItemClaimStatus(objVessel.AsLMAItem)
    
    Set datasource = Nothing
    Set objVessel = Nothing

End Sub

Private Sub cmdLab64_Click()

    Dim datasource As LMADataSource
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    Dim objFilter As LMAFilter
    Dim criterion As LMACriterion
    Set criterion = New LMACriterion
    Set objFilter = New LMAFilter
    
    criterion.SourceAttributeName = "Name"
    criterion.ValueAttribute = "Default Assembly Path"
    criterion.Operator = "="
    
    objFilter.ItemType = "OptionSetting"
    objFilter.Criteria.Add criterion
    
    Dim objOptionSettings As LMOptionSettings
    Dim objOptionSetting As LMOptionSetting
    Set objOptionSettings = New LMOptionSettings
    'get "Default Assembly Path" from OptionSettings by filter
    objOptionSettings.Collect datasource, Filter:=objFilter
    
    Set objOptionSetting = objOptionSettings.Nth(1)
    Debug.Print "Name = " & objOptionSetting.Attributes("Name").Value
    Debug.Print "Value = " & objOptionSetting.Attributes("Value").Value
  
    Set datasource = Nothing
    Set objFilter = Nothing
    Set criterion = Nothing
    Set objOptionSettings = Nothing
    Set objOptionSetting = Nothing

End Sub

Private Sub cmdLab64a_Click()
    Dim datasource As LMADataSource
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    Dim objFilter As LMAFilter
    Dim criterion As LMACriterion
    Set criterion = New LMACriterion
    Set objFilter = New LMAFilter
    
    'criterion.SourceAttributeName = "Name"
    'criterion.ValueAttribute = "Default Assembly Path"
    'criterion.Operator = "="
    
    objFilter.ItemType = "OptionSetting"
    objFilter.Criteria.Add criterion
    
    Dim objOptionSettings As LMOptionSettings
    Dim objOptionSetting As LMOptionSetting
    Set objOptionSettings = New LMOptionSettings
    'get "Default Assembly Path" from OptionSettings by filter
    objOptionSettings.Collect datasource ', Filter: =objFilter
    
    For Each objOptionSetting In objOptionSettings
    WriteToErrorLog "Name = " & objOptionSetting.Attributes("Name").Value & "    Value = " & objOptionSetting.Attributes("Value").Value
    Debug.Print "Name = " & objOptionSetting.Attributes("Name").Value & "    Value = " & objOptionSetting.Attributes("Value").Value
    'Debug.Print "Value = " & objOptionSetting.Attributes("Value").Value
    Next
 
    Set datasource = Nothing
    Set objFilter = Nothing
    Set criterion = Nothing
    Set objOptionSettings = Nothing
    Set objOptionSetting = Nothing


End Sub

Private Sub cmdLab65_Click()
Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim Item As LMAItem
    Dim dirpath As String

    Dim VesselLocation As String
    VesselLocation = "\Equipment\Vessels\Horizontal Drums\Horz Surge w-Horiz Dea.sym"
    'create a vessel into stockpile
    Set Item = objPlacement.PIDCreateItem(VesselLocation)
    If Item Is Nothing Then
        MsgBox "unsuccessful placement"
    End If
    
    Set objPlacement = Nothing
    Set Item = Nothing

End Sub

Private Sub cmdLab66_Click()
    Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim dirpath As String
    
    Dim symbol As LMSymbol
    Dim VesselLocation As String
    VesselLocation = "\Equipment\Vessels\Horizontal Drums\Horz Surge w-Horiz Dea.sym"
    
    'place a vessle into active drawing
    Set symbol = objPlacement.PIDPlaceSymbol(VesselLocation, 0.3, 0.2)
        
    If symbol Is Nothing Then
        MsgBox "unsuccessful placement"
    Else
    MsgBox " Successful Placement"
    End If
    
    Set objPlacement = Nothing
    Set symbol = Nothing

End Sub

Private Sub cmdLab67_Click()
    Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim strdirpath As String
    Dim nozzleName As String
    Dim trayName As String
    
    Dim xvessel As Double
    Dim yvessel As Double
    xvessel = 0.5
    yvessel = 0.3
    Dim symVessel As LMSymbol
    Dim symbol2 As LMSymbol
    Dim symbol3 As LMSymbol
    Dim symbol4 As LMSymbol
    Dim symbol5 As LMSymbol
    Dim vesselName As String
    Dim symbol21 As LMSymbol
    Dim symbol31 As LMSymbol
    
    vesselName = "\Equipment\Vessels\Vertical Drums\1D 1C 2to1.sym"
    nozzleName = "\Equipment Components\Nozzles\Flanged Nozzle with blind.sym"
    trayName = "\Equipment Components\Trays\Bubble Cap Trays\2-Pass Bubl Side.sym"
    
    'place a vessel
    Set symVessel = objPlacement.PIDPlaceSymbol(vesselName, xvessel, yvessel)
    'set Cleaning Requirement for the Vessel
    Dim objVessel As LMVessel
    Set objVessel = objPlacement.PIDDataSource.GetVessel(symVessel.ModelItemID)
    objVessel.Attributes("CleaningReqmts").Value = "CC1"
    'place two nozzles on vessel
    Set symbol2 = objPlacement.PIDPlaceSymbol(nozzleName, xvessel - 0.2, yvessel + 0.05, _
                TargetItem:=symVessel.AsLMRepresentation)
    Set symbol3 = objPlacement.PIDPlaceSymbol(nozzleName, xvessel + 0.2, yvessel + 0.07, _
                TargetItem:=symVessel.AsLMRepresentation)
    'place two trays on vessel
    Set symbol4 = objPlacement.PIDPlaceSymbol(trayName, xvessel - 0.05, yvessel + 0.05, _
                TargetItem:=symVessel.AsLMRepresentation)
    Set symbol5 = objPlacement.PIDPlaceSymbol(trayName, xvessel + 0.05, yvessel + 0.1, _
                TargetItem:=symVessel.AsLMRepresentation)
    
'''''    'place nozzles again use same X, Y coordinates, but this time set PIDSnapToTarget=false
'''''    objPlacement.PIDSnapToTarget = False
'''''    Set symbol21 = objPlacement.PIDPlaceSymbol(nozzleName, xvessel - 0.2, yvessel + 0.05, _
'''''                TargetItem:=symVessel.AsLMRepresentation)
'''''    Set symbol31 = objPlacement.PIDPlaceSymbol(nozzleName, xvessel + 0.2, yvessel + 0.07, _
'''''                TargetItem:=symVessel.AsLMRepresentation)
'''''    objPlacement.PIDSnapToTarget = True
    
'''''    'place nozzles again use new X, Y coordinates, but this time set PIDSetCopyPropertiesFlag=false
'''''    objPlacement.PIDSetCopyPropertiesFlag False
'''''    Set symbol21 = objPlacement.PIDPlaceSymbol(nozzleName, xvessel - 0.2, yvessel + 0.05, _
'''''                TargetItem:=symVessel.AsLMRepresentation)
'''''    Set symbol31 = objPlacement.PIDPlaceSymbol(nozzleName, xvessel + 0.2, yvessel + 0.07, _
'''''                TargetItem:=symVessel.AsLMRepresentation)
'''''    objPlacement.PIDSetCopyPropertiesFlag True

    Set objPlacement = Nothing
    Set symVessel = Nothing
    Set symbol2 = Nothing
    Set symbol3 = Nothing
    Set symbol4 = Nothing
    Set symbol5 = Nothing
'''''    Set symbol21 = Nothing
'''''    Set symbol31 = Nothing

End Sub

Private Sub cmdLab68_Click()
 Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim strdirpath As String
    Dim nozzleName As String
    Dim trayName As String
    Dim labelName1 As String
    Dim labelName2 As String
    Dim labelName3 As String
    Dim vessel As LMVessel
    Dim labelpersist As LMLabelPersist
    
    Dim xvessel As Double
    Dim yvessel As Double
    xvessel = 0.2
    yvessel = 0.2
    
    Dim symVessel As LMSymbol
    Dim vesselName As String
    Dim points(1 To 4) As Double
    Dim twopoints(1 To 2) As Double
    
    vesselName = "\Equipment\Vessels\Vertical Drums\1D 1C 2to1.sym"
    labelName1 = "\Equipment\Labels - Equipment\Equipment Name.sym"
    labelName2 = "\Equipment\Labels - Equipment\Insulation Purpose.sym"
    labelName3 = "\Equipment\Labels - Equipment\Heat Tracing.sym"
    
    'place vessel
    Set symVessel = objPlacement.PIDPlaceSymbol(vesselName, xvessel, yvessel)
    'get placed vessel and set some properties' value
    Set vessel = objPlacement.PIDDataSource.GetVessel(symVessel.ModelItemID)
    vessel.Name = "Vessel for Label Placement"
    vessel.InsulPurpose = "R15"
    vessel.HTraceMedium = "SS"
    vessel.HTraceMediumTemp = "300 F"
    vessel.HTraceReqmt = "ET"
    
    'place three different labels for the vessel
    twopoints(1) = xvessel + 0.02
    twopoints(2) = yvessel + 0.1
    Set labelpersist = objPlacement.PIDPlaceLabel(labelName1, _
         twopoints, Labeleditem:=symVessel.AsLMRepresentation)
    points(1) = xvessel
    points(2) = yvessel
    points(3) = xvessel - 0.05
    points(4) = yvessel + 0.1
    Set labelpersist = objPlacement.PIDPlaceLabel(labelName2, _
        points(), Labeleditem:=symVessel.AsLMRepresentation, _
        IsLeaderVisible:=True)

    points(1) = xvessel
    points(2) = yvessel
    points(3) = xvessel + 0.05
    points(4) = yvessel + 0.1
    Set labelpersist = objPlacement.PIDPlaceLabel(labelName3, _
        points(), Labeleditem:=symVessel.AsLMRepresentation, _
       IsLeaderVisible:=True)
           
    Set objPlacement = Nothing
    Set symVessel = Nothing
    Set labelpersist = Nothing

End Sub

Private Sub cmdLab69_Click()
Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim OPClocation As String
    OPClocation = "\Piping\Piping OPC's\Off-Drawing.sym"

    'place a vessle into active drawing
    Dim symbol As LMSymbol
    Set symbol = objPlacement.PIDPlaceSymbol(OPClocation, 0.1, 0.1)
    
    If symbol Is Nothing Then
        MsgBox "unsuccessful placement"
    End If
    
    Set objPlacement = Nothing
    Set symbol = Nothing

End Sub

Private Sub cmdLab70_Click()
    Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim OPClocation As String
    OPClocation = "\Piping\Piping OPC's\Off-Drawing.sym"
    
    Dim objOPC As LMOPC
    Dim objpairOPC As LMOPC
    
    Set objOPC = objPlacement.PIDDataSource.GetOPC(CONST_SPID_OPC)
    Set objpairOPC = objOPC.pairedWithOPCObject
    
    Dim objConnector As LMConnector
    Dim objPiperun As LMPipeRun
    Dim objRep As LMRepresentation
    
    Set objPiperun = objPlacement.PIDDataSource.GetPipeRun(CONST_SPID_PipeRun)
    For Each objRep In objPiperun.Representations
        If objRep.Attributes("RepresentationType").Value = "Connector" Then
            Set objConnector = objPlacement.PIDDataSource.GetConnector(objRep.ID)
            Exit For
        End If
    Next
    
    Dim x As Double
    Dim Y As Double
    
    x = objConnector.ConnectorVertices.Nth(1).Attributes("XCoordinate").Value
    Y = objConnector.ConnectorVertices.Nth(1).Attributes("YCoordinate").Value
    'place the OPC from stockpile into active drawing
    Dim symbol As LMSymbol
    Set symbol = objPlacement.PIDPlaceSymbol(OPClocation, x, Y, , , objpairOPC.AsLMAItem)
        
    If symbol Is Nothing Then
        MsgBox "unsuccessful placement"
    End If
    
    Set objPlacement = Nothing
    Set symbol = Nothing

End Sub

Private Sub cmdLab71_Click()
    Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim PipeRunLocation As String
    Dim objItem As LMAItem
    Dim objConnector As LMConnector
    Dim objInputs As PlaceRunInputs
    Dim objSymbol As LMSymbol
    Dim ValveLocation As String
    
    PipeRunLocation = "\Piping\Routing\Process Lines\Primary Piping.sym"
    
    Set objInputs = New PlaceRunInputs
    objInputs.AddPoint 0.1, 0.1
    objInputs.AddPoint 0.2, 0.1
    
    Set objItem = objPlacement.PIDCreateItem(PipeRunLocation)
    Set objConnector = objPlacement.PIDPlaceRun(objItem, objInputs)
    
    ValveLocation = "\Piping\Valves\2 Way Common\Ball Valve.sym"
    Set objSymbol = objPlacement.PIDPlaceSymbol(ValveLocation, 0.15, 0.3, , 1.57)
    
    Set objInputs = New PlaceRunInputs
    objInputs.AddConnectorTarget objConnector, 0.15, 0.1
    objInputs.AddPoint 0.15, 0.15
    objInputs.AddPoint 0.12, 0.15
    objInputs.AddPoint 0.12, 0.2
    objInputs.AddPoint 0.15, 0.2
    objInputs.AddSymbolTarget objSymbol, 0.15, 0.3
    
    Set objItem = objPlacement.PIDCreateItem(PipeRunLocation)
    Set objConnector = objPlacement.PIDPlaceRun(objItem, objInputs)
'clean up
    Set objPlacement = Nothing
    Set objItem = Nothing
    Set objConnector = Nothing
    Set objSymbol = Nothing
    Set objInputs = Nothing

End Sub

Private Sub cmdLab72_Click()
 Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim PipeRunLocation As String
    Dim objItem As LMAItem
    Dim objConnector As LMConnector
    Dim objInputs As PlaceRunInputs
    Dim objSymbol As LMSymbol
    Dim VesselLocation As String
    Dim NozzleLocation As String
    Dim objPiperuns As LMPipeRuns
    Dim objPiperun As LMPipeRun
    Dim objSurvivorItem As LMAItem
    
    Set objPiperuns = New LMPipeRuns
    
    PipeRunLocation = "\Piping\Routing\Process Lines\Primary Piping.sym"
    
    Set objInputs = New PlaceRunInputs
    objInputs.AddPoint 0.1, 0.1
    objInputs.AddPoint 0.2, 0.1
    
    'first piperun
    Set objItem = objPlacement.PIDCreateItem(PipeRunLocation)
    Set objConnector = objPlacement.PIDPlaceRun(objItem, objInputs)
    
    Set objInputs = New PlaceRunInputs
    objInputs.AddLocatedTarget 0.15, 0.1
    objInputs.AddPoint 0.15, 0.3
    
    'second piperun
    Set objItem = objPlacement.PIDCreateItem(PipeRunLocation)
    Set objConnector = objPlacement.PIDPlaceRun(objItem, objInputs)
    objPiperuns.Add objPlacement.PIDDataSource.GetPipeRun(objConnector.ModelItemID)
    
    VesselLocation = "\Equipment\Vessels\Vertical Drums\1D 1C 2to1.sym"
    NozzleLocation = "\Equipment Components\Nozzles\Flanged Nozzle with blind.sym"
    
    Set objSymbol = objPlacement.PIDPlaceSymbol(VesselLocation, 0.15, 0.5)
    Set objSymbol = objPlacement.PIDPlaceSymbol(NozzleLocation, 0.15, 0.5 - 0.1, TargetItem:=objSymbol.AsLMRepresentation)
    
    Set objInputs = New PlaceRunInputs
    objInputs.AddConnectorTarget objConnector, 0.15, 0.3
    objInputs.AddSymbolTarget objSymbol, objSymbol.Attributes("XCoordinate"), objSymbol.Attributes("YCoordinate")
    
    'third piperun
    Set objItem = objPlacement.PIDCreateItem(PipeRunLocation)
    Set objConnector = objPlacement.PIDPlaceRun(objItem, objInputs)
    objPiperuns.Add objPlacement.PIDDataSource.GetPipeRun(objConnector.ModelItemID)
    
    'AutoJoin
    For Each objPiperun In objPiperuns
        objPlacement.PIDAutoJoin objPiperun.AsLMAItem, autoJoin_Both, objSurvivorItem
    Next
    
    MsgBox "Done!"
'clean up
    Set objPlacement = Nothing
    Set objItem = Nothing
    Set objConnector = Nothing
    Set objSymbol = Nothing
    Set objInputs = Nothing

End Sub

Private Sub cmdLab73_Click()
    Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim PipeRunLocation As String
    PipeRunLocation = "\Piping\Routing\Process Lines\Primary Piping.sym"
    
    Dim twopoints(1 To 4) As Double
    twopoints(1) = 0.2
    twopoints(2) = 0.2
    twopoints(3) = 0.4
    twopoints(4) = 0.2
   
    Dim objConnector As LMConnector
    Set objConnector = objPlacement.PIDPlaceConnector(PipeRunLocation, twopoints)
     
    
    Dim gaplocation As String
    gaplocation = "\Piping\Gaps\gap-lines.sym"
    Dim objSymbol As LMSymbol
    Set objSymbol = objPlacement.PIDPlaceGap(gaplocation, 0.3, 0.2, 0.02, 0.02, objConnector, -1.57)
    
    Set objConnector = Nothing
    Set objSymbol = Nothing
    Set objPlacement = Nothing

End Sub

Private Sub cmdLab74_Click()
Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim datasource As LMADataSource
    Set datasource = objPlacement.PIDDataSource
   
    Dim VesselLocation As String
    VesselLocation = "\Equipment\Vessels\Vertical Drums\1D 1C 2to1.sym"
    
    'place a vessel
    Dim objSymbol1 As LMSymbol
    Set objSymbol1 = objPlacement.PIDPlaceSymbol(VesselLocation, 0.25, 0.25)
    
    'place a nozzle on the vessel
    Dim NozzleLocation As String
    NozzleLocation = "\Equipment Components\Nozzles\Flanged Nozzle with blind.sym"
    Dim objSymbol2 As LMSymbol
    Set objSymbol2 = objPlacement.PIDPlaceSymbol(NozzleLocation, 0#, 0#, , , , objSymbol1.AsLMRepresentation)
    
    Dim points(1 To 10) As Double
    points(1) = 0.1
    points(2) = 0.1
    points(3) = 0.4
    points(4) = 0.1
    points(5) = 0.4
    points(6) = 0.4
    points(7) = 0.1
    points(8) = 0.4
    points(9) = 0.1
    points(10) = 0.1
    
    'place BoundedShape(it is a AreaBreak)
    Dim boundedshapelocation As String
    boundedshapelocation = "\Design\Area Break.sym"
    Dim objBoundedShaped As LMBoundedShape
    Set objBoundedShaped = objPlacement.PIDPlaceBoundedShape(boundedshapelocation, points)
    
    'get the placed vessel
    Dim objVessel As LMVessel
    Set objVessel = datasource.GetVessel(objSymbol1.ModelItemID)
    
    'get the BoundedShpae(AreaBreak) as PlantItemGroup
    Dim objPlantItemGroup As LMPlantItemGroup
    Set objPlantItemGroup = datasource.GetPlantItemGroup(objBoundedShaped.ModelItemID)
    
    Debug.Print "The vessel belongs to how many plantitemgroups? = " & objVessel.PlantItemGroups.Count
    
    'add the vessel to the PlantItemGroup
    objVessel.PlantItemGroups.Add objPlantItemGroup
    'objVessel.Commit
    Debug.Print "The vessel belongs to how many plantitemgroups? = " & objVessel.PlantItemGroups.Count
    
    Set objPlacement = Nothing
    Set datasource = Nothing

End Sub

Private Sub cmdLab75_Click()
Dim objPlacement As Placement
    Set objPlacement = New Placement
   
    Dim AssemblyLocation As String
    AssemblyLocation = "\Assemblies\test.pid"
    
    Dim objItems As LMAItems
    'place assembly
    Set objItems = objPlacement.PIDPlaceAssembly(AssemblyLocation, 0.3, 0.3) 'It was 0#, 0#
    If objItems.Count <> 0 Then
        MsgBox "Place Assembly Completed"
    Else
        MsgBox "Not a blank Drawing"
        
    End If
    
    Set objPlacement = Nothing
    Set objItems = Nothing

End Sub

Private Sub cmdLab76_Click()
    Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim objRep As LMRepresentation
    Dim objVessel As LMVessel
    Dim objSym As LMSymbol
    Dim VesselLocation As String
    
    VesselLocation = "\Equipment\Vessels\Horizontal Drums\Horz Surge w-Horiz Dea.sym"
    'place a vessel into drawing
    Set objSym = objPlacement.PIDPlaceSymbol(VesselLocation, 0.2, 0.2)
    
    Set objVessel = objPlacement.PIDDataSource.GetVessel(objSym.ModelItemID)
    Set objRep = objVessel.Representations.Nth(1)
    'remove the vessel from drawing into stockpile
    Dim success As Boolean
    success = objPlacement.PIDRemovePlacement(objRep)
    If success Then
        MsgBox "Symbol removed successfully"
    Else
        MsgBox "RemovePlacement unsuccessful"
    End If
    
    Set objPlacement = Nothing
    Set objVessel = Nothing
    Set objRep = Nothing
   

End Sub

Private Sub cmdLab77_Click()
Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim objItem As LMAItem
    Dim success As Boolean
    Dim objSym As LMSymbol
    Dim VesselLocation As String
    
    VesselLocation = "\Equipment\Vessels\Horizontal Drums\Horz Surge w-Horiz Dea.sym"
    'place a vessel into drawing
    Set objSym = objPlacement.PIDPlaceSymbol(VesselLocation, 0.2, 0.2)
    
    Set objItem = objPlacement.PIDDataSource.GetVessel(objSym.ModelItemID).AsLMAItem
    success = False
    success = objPlacement.PIDDeleteItem(objItem)
    If success Then
        MsgBox "deletion from drawing successfully"
    Else
        MsgBox "deletion from drawing unsuccessful"
    End If
    
    Dim Item As LMAItem
    Set Item = objPlacement.PIDCreateItem(VesselLocation)
    Set objItem = objPlacement.PIDDataSource.GetVessel(Item.ID).AsLMAItem
    success = False
    success = objPlacement.PIDDeleteItem(objItem)
    If success Then
        MsgBox "deletion from stockpile successfully"
        
    Else
        MsgBox "deletion from stockpile unsuccessful"
    End If
    
    Set objPlacement = Nothing
    Set objItem = Nothing

End Sub

Private Sub cmdLab78_Click()
Dim objPlacement As Placement
    Set objPlacement = New Placement
   
    Dim VesselLocation As String
    VesselLocation = "\Equipment\Vessels\Vertical Drums\1D 1C 2to1.sym"
    'place a vessel
    Dim objSymbol1 As LMSymbol
    Set objSymbol1 = objPlacement.PIDPlaceSymbol(VesselLocation, 0.2, 0.2)
    
    Dim NozzleLocation As String
    NozzleLocation = "\Equipment Components\Nozzles\Flanged Nozzle with blind.sym"
    'place a nozzle on the vessel
    Dim objSymbol2 As LMSymbol
    Set objSymbol2 = objPlacement.PIDPlaceSymbol(NozzleLocation, 0.3, 0.2, , , , objSymbol1.AsLMRepresentation)
    
    'replace the vessel, note nozzle is still on the new vessel
    Dim replacevesselname As String
    replacevesselname = "\Equipment\Vessels\Vertical Drums\2to1Parametric V Drum.sym"

    Dim objSymbol3 As LMSymbol
    Set objSymbol3 = objPlacement.PIDReplaceSymbol(replacevesselname, objSymbol1)
    
    
    Set objSymbol1 = Nothing
    Set objSymbol2 = Nothing
    Set objSymbol3 = Nothing
    Set objPlacement = Nothing

End Sub

Private Sub cmdLab79_Click()
Dim objPlacement As Placement
    Set objPlacement = New Placement
   
    Dim VesselLocation As String
    VesselLocation = "\Equipment\Vessels\Vertical Drums\2to1Parametric V Drum.sym"
    'place a vessel
    Dim objSymbol1 As LMSymbol
    Set objSymbol1 = objPlacement.PIDPlaceSymbol(VesselLocation, 0.2, 0.2)
    
    'get the vessel and set some properties' value
    Dim objVessel As LMVessel
    Set objVessel = objPlacement.PIDDataSource.GetVessel(objSymbol1.ModelItemID)
    objVessel.Attributes("Name").Value = "V1"
    objVessel.Attributes("TagPrefix").Value = "T"
    objVessel.Commit
    
    Dim labelName1 As String
    labelName1 = "\Equipment\Labels - Equipment\Equipment Name.sym"
    Dim twopoints(1 To 4) As Double
    twopoints(1) = 0.21
    twopoints(2) = 0.25
    twopoints(3) = 0.1
    twopoints(4) = 0.1
    
    'place a label on the vessel
    Dim objLabelPersist1 As LMLabelPersist
    Set objLabelPersist1 = objPlacement.PIDPlaceLabel(labelName1, twopoints, , , objSymbol1.AsLMRepresentation, True)
    
    Dim replacelabelname As String
    replacelabelname = "\Equipment\Labels - Equipment\Equipment ID.sym"
    
    'replace the label with new label
    Dim objLabelPersist2 As LMLabelPersist
    Set objLabelPersist2 = objPlacement.PIDReplaceLabel(replacelabelname, objLabelPersist1)
    
    Set objSymbol1 = Nothing
    Set objLabelPersist1 = Nothing
    Set objLabelPersist2 = Nothing
    Set objPlacement = Nothing

End Sub

Private Sub cmdLab80_Click()
    Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim OPClocation As String
    OPClocation = "\Piping\Piping OPC's\Off-Drawing-New.sym"
    
    Dim objOPC As LMOPC
    
    Set objOPC = objPlacement.PIDDataSource.GetOPC(CONST_SPID_OPC2)
    
    Dim objSymbol As LMSymbol
    Set objSymbol = objPlacement.PIDDataSource.GetSymbol(objOPC.Representations.Nth(1).ID)
    
    Dim objSymbol1 As LMSymbol
    Set objSymbol1 = objPlacement.PIDReplaceSymbol(OPClocation, objSymbol)
    
    Set objSymbol = Nothing
    Set objSymbol1 = Nothing
    Set objOPC = Nothing
    Set objPlacement = Nothing

End Sub



Private Sub cmdLab81_Click()
Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim VesselLocation As String
    VesselLocation = "\Equipment\Vessels\Vertical Drums\2to1Parametric V Drum.sym"
    Dim objSymbol1 As LMSymbol
    Set objSymbol1 = objPlacement.PIDPlaceSymbol(VesselLocation, 0.2, 0.2, True, 1.57)
   
    Dim NozzleLocation As String
    NozzleLocation = "\Equipment Components\Nozzles\Flanged Nozzle with blind.sym"
    Dim objSymbol2 As LMSymbol
    Set objSymbol2 = objPlacement.PIDPlaceSymbol(NozzleLocation, 0.22, 0.4, , , , objSymbol1.AsLMRepresentation)
        
    Dim names(1 To 2) As String
    Dim values(1 To 2) As String
    names(1) = "Top"
    names(2) = "Right"
    values(1) = "0.38"
    values(2) = "0.2"
    
    objPlacement.PIDApplyParameters objSymbol1.AsLMRepresentation, names, values
    
    Set objSymbol1 = Nothing
    Set objSymbol2 = Nothing
    Set objPlacement = Nothing

End Sub

Private Sub cmdLab82_Click()
 Dim objPlacement As Placement
    Set objPlacement = New Placement
    
    Dim SignalRunLocation As String
    Dim objItem As LMAItem
    Dim objConnector As LMConnector
    Dim objInputs As PlaceRunInputs
    Dim objSymbol As LMSymbol
    Dim InstrLocation As String
    Dim blnSuccess As Boolean
    Dim x As Double, Y As Double
    
    SignalRunLocation = "\Instrumentation\Signal Line\Electric Binary.sym"
    
    
    InstrLocation = "\Instrumentation\Off-Line\With Implied Components\Level\Discr Field Mounted LC.sym"
    Set objSymbol = objPlacement.PIDPlaceSymbol(InstrLocation, 0.3, 0.3)
    
    blnSuccess = objPlacement.PIDConnectPointLocation(objSymbol, 3, x, Y)
    
    Set objInputs = New PlaceRunInputs
    objInputs.AddPoint 0.2, 0.3
    objInputs.AddSymbolTarget objSymbol, x, Y
    
    Set objItem = objPlacement.PIDCreateItem(SignalRunLocation)
    Set objConnector = objPlacement.PIDPlaceRun(objItem, objInputs)
    
'clean up
    Set objPlacement = Nothing
    Set objItem = Nothing
    Set objConnector = Nothing
    Set objSymbol = Nothing
    Set objInputs = Nothing

End Sub

Private Sub cmdLab85_Click()
    Dim datasource As LMADataSource
    Dim objPIDAutoApp As PIDAutomation.Application
    Dim objPIDADrawing As PIDAutomation.Drawing
    Dim objDrawing As LMDrawing
    Dim objDrawings As LMDrawings
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    Set objDrawings = New LMDrawings
    objDrawings.Collect datasource
    
    Set objPIDAutoApp = CreateObject("PIDAutomation.Application")
    
    For Each objDrawing In objDrawings
        If objDrawing.Attributes("ItemStatus").Index = 1 Then '1 stands for Active
            Set objPIDADrawing = objPIDAutoApp.Drawings.OpenDrawing(objDrawing.Attributes("Name"))
            If Not objPIDADrawing Is Nothing Then
                MsgBox "Drawing " & objDrawing.Attributes("Name").Value & " is opened!"
                objPIDADrawing.CloseDrawing True
            End If
        End If
    Next
    
    objPIDAutoApp.Quit
    Set objPIDAutoApp = Nothing
    Set objPIDADrawing = Nothing
    Set objDrawing = Nothing
    Set objDrawings = Nothing

End Sub

Private Sub cmdLab86_Click()
    Dim datasource As LMADataSource
    Dim objPIDAutoApp As PIDAutomation.Application
    Dim objPIDADrawing As PIDAutomation.Drawing
    Dim PlantGroupName As String
    Dim TemplateFileName As String
    Dim DrawingNumber As String
    Dim DrawingName As String
    
    If Not blnUsePIDDatasource Then
        Set datasource = New LMADataSource
    Else
        Set datasource = PIDDataSource
    End If
    
    Set objPIDAutoApp = CreateObject("PIDAutomation.Application")
    
    PlantGroupName = "Unit01"
    'considering accessing T_OptinSetting to read the template files path, which will be more flexible
    TemplateFileName = "\\102a-3\hostsite\TrainingPlant1\P&ID Reference Data\template files\C-Size.pid"
    DrawingNumber = "TestCreateNewDrawing1"
    DrawingName = "TestCreateNewDrawing1"
    Set objPIDADrawing = objPIDAutoApp.Drawings.Add(PlantGroupName, TemplateFileName, DrawingNumber, DrawingName)
    If Not objPIDADrawing Is Nothing Then
        MsgBox "Drawing " & objPIDADrawing.Name & " is opened!"
        objPIDADrawing.CloseDrawing True
    End If
    
    objPIDAutoApp.Quit
    Set objPIDAutoApp = Nothing
    Set objPIDADrawing = Nothing

End Sub

Private Sub cmdLab87_Click()
    Dim datasource As LMADataSource
    Dim objPIDAutoApp As PIDAutomation.Application
    Dim objPIDADrawing As PIDAutomation.Drawing
    Dim PlantGroupName As String
    Dim TemplateFileName As String
    Dim DrawingNumber As String
    Dim DrawingName As String
    Dim objPlacement As Placement
    Dim AssemblyLocation As String
    Dim objItems As LMAItems
    Dim objItem As LMAItem
    Dim objConnector As LMConnector
    Dim objPiperun As LMPipeRun
    Dim i As Long
    
    Set objPIDAutoApp = CreateObject("PIDAutomation.Application")
    
    PlantGroupName = "Unit01"
    'considering accessing T_OptinSetting to read the template files path, which will be more flexible
    TemplateFileName = "\\102a-3\hostsite\TrainingPlant1\P&ID Reference Data\template files\E-Size.pid"
    For i = 3 To 6
    
    DrawingNumber = "TestCreateNewDrawing" & i
    DrawingName = "TestCreateNewDrawing" & i
    Set objPIDADrawing = objPIDAutoApp.Drawings.Add(PlantGroupName, TemplateFileName, DrawingNumber, DrawingName)
    Next
    
    If Not objPIDADrawing Is Nothing Then
        Set objPlacement = New Placement
        Set datasource = objPlacement.PIDDataSource
        AssemblyLocation = "\Assemblies\Automation.pid"
        'place assembly
        Set objItems = objPlacement.PIDPlaceAssembly(AssemblyLocation, 0.2, 0.2)
        'change TagSequenceNo
        For Each objItem In objItems
            If objItem.ItemType = "Connector" Then
                Set objConnector = datasource.GetConnector(objItem.ID)
                If objConnector.ModelItemObject.AsLMAItem.ItemType = "PipeRun" Then
                    Set objPiperun = datasource.GetPipeRun(objConnector.ModelItemID)
                    objPiperun.Attributes("TagSequenceNo").Value = 100
                    objPiperun.Commit
                End If
            End If
        Next
        objPIDADrawing.CloseDrawing True
    End If
    
    objPIDAutoApp.Quit
    Set objPIDAutoApp = Nothing
    Set objPIDADrawing = Nothing

End Sub

Private Sub cmdLab87a_Click()


End Sub

Private Sub cmdLab88_Click()

End Sub

Private Sub Form_Load()
    If Option1 Then
        blnUsePIDDatasource = False
    Else
        blnUsePIDDatasource = True
    End If
End Sub

Private Sub Option1_Click()
    
    blnUsePIDDatasource = False
    
End Sub

Private Sub Option2_Click()

    blnUsePIDDatasource = True
    
End Sub

Private Sub cmdExit_Click()
    Unload Me
End Sub

'this function write a line of string to log file
Private Sub WriteToErrorLog(strMessage As String)
    Dim intFileNumber As Integer


    'write message to error log file
    intFileNumber = FreeFile()
    Open Environ("TEMP") & "\SPATraining.log" For Append As #intFileNumber  'or you could just write over it using "for append as
    Print #intFileNumber, Date & " " & Time & "   " & strMessage
    Close #intFileNumber
End Sub


